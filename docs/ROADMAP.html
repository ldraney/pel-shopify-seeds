<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>PEL Shopify Seeds - Roadmap</title>
    <script src="https://cdn.jsdelivr.net/npm/mermaid/dist/mermaid.min.js"></script>
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            max-width: 1000px;
            margin: 0 auto;
            padding: 2rem;
            background: #f5f5f5;
        }
        h1, h2, h3 { color: #333; }
        .phase {
            background: white;
            border-radius: 8px;
            padding: 1.5rem;
            margin: 1.5rem 0;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        .phase-header {
            display: flex;
            align-items: center;
            gap: 1rem;
            margin-bottom: 1rem;
        }
        .phase-number {
            background: #007bff;
            color: white;
            width: 2rem;
            height: 2rem;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
        }
        .phase.complete .phase-number { background: #28a745; }
        .phase.current .phase-number { background: #ffc107; color: #333; }
        .phase.legacy .phase-number { background: #6c757d; }
        .issue-link {
            background: #e9ecef;
            padding: 0.25rem 0.5rem;
            border-radius: 4px;
            text-decoration: none;
            color: #333;
            font-size: 0.9rem;
        }
        .issue-link:hover { background: #dee2e6; }
        .deliverables {
            background: #f8f9fa;
            padding: 1rem;
            border-radius: 4px;
            margin-top: 1rem;
        }
        .diagram-container {
            background: white;
            border-radius: 8px;
            padding: 2rem;
            margin: 2rem 0;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        code {
            background: #e9ecef;
            padding: 0.2rem 0.4rem;
            border-radius: 3px;
            font-size: 0.9rem;
        }
        table { width: 100%; border-collapse: collapse; margin: 1rem 0; }
        th, td { border: 1px solid #ddd; padding: 0.75rem; text-align: left; }
        th { background: #f8f9fa; }
        .note {
            background: #fff3cd;
            border-left: 4px solid #ffc107;
            padding: 1rem;
            margin: 1rem 0;
        }
    </style>
</head>
<body>
    <h1>PEL Shopify Seeds - Roadmap</h1>

    <p>This repo provides CSV data + API response schemas for pel-shopify-views to consume.</p>

    <div class="diagram-container">
        <pre class="mermaid">
flowchart LR
    subgraph seeds["pel-shopify-seeds"]
        CSV[products.csv]
        TYPES[api/types.js]
        INTRO[src/introspect.js]
    end

    subgraph views["pel-shopify-views"]
        PARSE[Parse CSV]
        APICALL[Call Shopify API]
        BUILD[Build SQLite]
    end

    SHOPIFY[(Shopify API)] --> INTRO
    INTRO --> TYPES
    CSV --> PARSE
    TYPES --> APICALL
    SHOPIFY --> APICALL
    PARSE --> BUILD
    APICALL --> BUILD
    BUILD --> DB[(catalog.sqlite)]
        </pre>
    </div>

    <div class="diagram-container">
        <pre class="mermaid">
gantt
    title Implementation Phases
    dateFormat  YYYY-MM-DD
    section Phase 1
    Documentation & Architecture     :done, p1, 2024-01-01, 1d
    section Phase 2
    First Release (CSV)              :done, p2, after p1, 1d
    section Phase 3 (Legacy)
    Collections JSON                 :done, p3a, after p2, 1d
    Inventory JSON                   :done, p3b, after p2, 1d
    section Phase 4
    Schema Introspection             :done, p4, after p3a p3b, 2d
    section Phase 5
    pel-shopify-views integration    :p5, after p4, 3d
        </pre>
    </div>

    <h2>Phase Overview</h2>

    <div class="phase complete">
        <div class="phase-header">
            <div class="phase-number">1</div>
            <h3>Documentation & Architecture</h3>
            <span style="color: #28a745; font-weight: bold;">COMPLETE</span>
        </div>
        <p>Establish the foundation with clear architecture documentation.</p>
        <div class="deliverables">
            <strong>Deliverables:</strong>
            <ul>
                <li><code>docs/architecture.html</code> - System architecture with Mermaid diagrams</li>
                <li>Shopify Admin API reference (queries, types, fields)</li>
                <li>CSV vs API data split analysis</li>
            </ul>
        </div>
    </div>

    <div class="phase complete">
        <div class="phase-header">
            <div class="phase-number">2</div>
            <h3>First Release</h3>
            <a href="https://github.com/ldraney/pel-shopify-seeds/issues/2" class="issue-link">Issue #2</a>
            <span style="color: #28a745; font-weight: bold;">COMPLETE</span>
        </div>
        <p>Create the first GitHub release with the product CSV export.</p>
        <div class="deliverables">
            <strong>Deliverables:</strong>
            <ul>
                <li>Validated <code>data/products.csv</code> (65 columns, 1656 products)</li>
                <li>GitHub Release v0.1.0, v0.2.0 with CSV attached</li>
            </ul>
        </div>
    </div>

    <div class="phase legacy">
        <div class="phase-header">
            <div class="phase-number">3</div>
            <h3>Legacy: JSON Data Files</h3>
            <a href="https://github.com/ldraney/pel-shopify-seeds/issues/1" class="issue-link">Issue #1</a>
            <a href="https://github.com/ldraney/pel-shopify-seeds/issues/3" class="issue-link">Issue #3</a>
            <span style="color: #6c757d; font-weight: bold;">SUPERSEDED</span>
        </div>
        <div class="note">
            <strong>Architecture Change:</strong> We originally planned to store JSON data files here.
            Instead, seeds will provide <strong>schema definitions</strong> and views will call the Shopify API directly.
            The JSON files created are legacy and will be replaced by <code>api/types.js</code>.
        </div>
        <div class="deliverables">
            <strong>Legacy Files (to be replaced):</strong>
            <ul>
                <li><code>api/collections.json</code> - Example data (Issue #1)</li>
                <li><code>api/collections.schema.json</code> - JSON Schema</li>
                <li><code>api/inventory.json</code> - Example data (Issue #3)</li>
                <li><code>api/inventory.schema.json</code> - JSON Schema</li>
            </ul>
        </div>
    </div>

    <div class="phase complete">
        <div class="phase-header">
            <div class="phase-number">4</div>
            <h3>Schema Introspection</h3>
            <a href="https://github.com/ldraney/pel-shopify-seeds/issues/7" class="issue-link">Issue #7</a>
            <span style="color: #28a745; font-weight: bold;">COMPLETE</span>
        </div>
        <p>Introspect Shopify GraphQL API to generate response schemas that views can use to create matching SQLite tables.</p>
        <div class="deliverables">
            <strong>Deliverables:</strong>
            <ul>
                <li><code>src/introspect.js</code> - Script to call Shopify API and extract types</li>
                <li><code>api/types.js</code> - Generated response schemas for:
                    <ul>
                        <li>Collection</li>
                        <li>InventoryItem</li>
                        <li>InventoryLevel</li>
                        <li>Location</li>
                    </ul>
                </li>
            </ul>
            <strong>Why introspection?</strong>
            <ul>
                <li>Ensures schemas match actual Shopify API responses</li>
                <li>Views can create SQLite tables that exactly match API response structure</li>
                <li>No manual schema maintenance - regenerate when API changes</li>
            </ul>
        </div>
    </div>

    <div class="phase">
        <div class="phase-header">
            <div class="phase-number">5</div>
            <h3>Integration with pel-shopify-views</h3>
        </div>
        <p>Ensure seeds releases are consumable by pel-shopify-views.</p>
        <div class="deliverables">
            <strong>Deliverables:</strong>
            <ul>
                <li>Release v0.3.0 with CSV + api/types.js</li>
                <li>Views repo successfully builds SQLite from seeds release</li>
                <li>Documentation for release process</li>
            </ul>
        </div>
    </div>

    <h2>Updated File Structure</h2>
    <pre><code>pel-shopify-seeds/
├── .github/
│   ├── release.yml
│   └── RELEASE_CHECKLIST.md
├── .gitignore
├── CLAUDE.md
├── README.md
├── data/                        # gitignored
│   └── products.csv             # 65 columns, 1656 products
├── api/
│   ├── types.js                 # NEW: Generated from introspection
│   ├── collections.json         # LEGACY: To be removed
│   ├── collections.schema.json  # LEGACY: To be removed
│   ├── inventory.json           # LEGACY: To be removed
│   └── inventory.schema.json    # LEGACY: To be removed
├── src/
│   └── introspect.js            # NEW: Schema introspection script
└── docs/
    ├── architecture.html
    └── ROADMAP.html</code></pre>

    <h2>Dependencies Between Issues</h2>

    <div class="diagram-container">
        <pre class="mermaid">
flowchart TD
    I2[Issue #2: First Release] --> I1[Issue #1: Collections JSON]
    I2 --> I3[Issue #3: Inventory JSON]
    I1 --> I7[Issue #7: Schema Introspection]
    I3 --> I7
    I7 --> I5[Phase 5: Integration]

    style I2 fill:#28a745
    style I1 fill:#6c757d
    style I3 fill:#6c757d
    style I7 fill:#ffc107
    style I5 fill:#e9ecef
        </pre>
    </div>

    <h2>What Seeds Provides to Views</h2>

    <table>
        <thead>
            <tr><th>Asset</th><th>Purpose</th><th>Views Usage</th></tr>
        </thead>
        <tbody>
            <tr>
                <td><code>products.csv</code></td>
                <td>Product data export</td>
                <td>Parse into <code>products_raw</code> table</td>
            </tr>
            <tr>
                <td><code>api/types.js</code></td>
                <td>API response schemas</td>
                <td>Create matching tables, validate API responses</td>
            </tr>
        </tbody>
    </table>

    <script>
        mermaid.initialize({
            startOnLoad: true,
            theme: 'default'
        });
    </script>
</body>
</html>
